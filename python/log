max_vals = [65535, 8000, 2330, 746810, 8000, 57199, 5277, 225635, 3565, 14, 310, 25304793, 21836]
cat_sizes = np.array(
    [18576837, 29427, 15127, 7295, 19901, 3, 6465, 1310, 61, 11700067, 622921, 219556, 10, 2209, 9779, 71, 4, 963, 14,
     22022124, 4384510, 15960286, 290588, 10829, 95, 34])
FNN (2 hidden layer): 0.606657819905
LR (xgb): 0.578476

day_0_train, day_0_test

LR dim < 10000
[ 3  5  6  7  8 12 13 14 15 16 17 18 24 25] 28313
eval-auc:0.708240	train-auc:0.815836
sample * 10
eval-auc:0.728586	train-auc:0.764369
sample * 15
eval-auc:0.735025	train-auc:0.757772
sample * 30
eval-auc:0.738229	train-auc:0.754945

LR dim < 1000
eval-auc:0.688261	train-auc:0.690440

LR dim < 100000
eval-auc:0.700934	train-auc:0.877140

LR dim > 0
eval-auc:0.694772	train-auc:0.952268


FM

50 100 0.001
train auc: 0.8957	test auc: 0.6786
50 100 0.001 x10
train auc: 0.7615	test auc: 0.7190

10 100 0.001
train auc: 0.8320	test auc: 0.6886
10 100 0.001 x10
train auc: 0.7483	test auc: 0.7156
10 100 0.001 x15
train auc: 0.7546	test auc: 0.7331

train
10000000 1e-05 2 0.0012
train auc: 0.7490	test auc: 0.7125

train_x10
80000000 0.003 2 0.0011
train auc: 0.7338	test auc: 0.7156

full dataset
nds.10.shuf: 168,446,888
test.nds.10.shuf: 25,076,873
test.unif.10.shuf: 19,408,357
decomposition:
filter: > 10
size        weight      count   ratio
23701761	0.841548	631838	0.026658
31928	    0.999878	25296	0.792283
15837	    0.999994	15533	0.980804
7363	    0.999995	7108	0.965367
20088	    0.999984	19272	0.959379
3	        1.000000	3	    1.000000
6772	    1.000000	6753	0.997194
1355	    0.999999	1302	0.960886
61	        1.000000	54	    0.885246
14774452	0.897614	527814	0.035725
750926	    0.993628	147690	0.196677
238887	    0.998072	110673	0.463286
10	        1.000000	10	    1.000000
2209	    1.000000	2201	0.996378
10223	    0.999979	9022	0.882520
73	        1.000000	62	    0.849315
4	        1.000000	4	    1.000000
966	        1.000000	945	    0.978261
14	        1.000000	14	    1.000000
27699023	0.821107	639541	0.023089
5525455	    0.958662	357566	0.064712
20377090	0.861559	600327	0.029461
317594	    0.997102	118441	0.372932
11325	    0.999980	10216	0.902075
96	        1.000000	77	    0.802083
34	        1.000000	33	    0.970588
max_vals = [65535, 8000, 705, 249000, 7974, 14159, 946, 43970, 5448, 11, 471, 35070017, 8376]
cat_sizes = np.array([631839, 25297, 15534, 7109, 19273, 4, 6754, 1303, 55, 527815, 147691, 110674, 11, 2202, 9023, 63, 5, 946, 15, 639542, 357567, 600328, 118442, 10217, 78, 34])

freqency filter stats:
>>> foo(10)
dimension 93493549->3231795
field	t_size	t_weight	f_size	f_weight	fs_ratio	fw_ratio
  0  23701761   212932118    631838   179192691	0.0267	0.8415
  1     31928   212932118     25296   212906183	0.7923	0.9999
  2     15837   212932118     15533   212930776	0.9808	1.0000
  3      7363   212932118      7108   212931144	0.9654	1.0000
  4     20088   212932118     19272   212928684	0.9594	1.0000
  5         3   212932118         3   212932118	1.0000	1.0000
  6      6772   212932118      6753   212932043	0.9972	1.0000
  7      1355   212932118      1302   212932009	0.9609	1.0000
  8        61   212932118        54   212932098	0.8852	1.0000
  9  14774452   212932118    527814   191130939	0.0357	0.8976
 10    750926   212932118    147690   211575250	0.1967	0.9936
 11    238887   212932118    110673   212521561	0.4633	0.9981
 12        10   212932118        10   212932118	1.0000	1.0000
 13      2209   212932118      2201   212932068	0.9964	1.0000
 14     10223   212932118      9022   212927621	0.8825	1.0000
 15        73   212932118        62   212932082	0.8493	1.0000
 16         4   212932118         4   212932118	1.0000	1.0000
 17       966   212932118       945   212932018	0.9783	1.0000
 18        14   212932118        14   212932118	1.0000	1.0000
 19  27699023   212932118    639541   174840006	0.0231	0.8211
 20   5525455   212932118    357566   204129842	0.0647	0.9587
 21  20377090   212932118    600327   183453551	0.0295	0.8616
 22    317594   212932118    118441   212315062	0.3729	0.9971
 23     11325   212932118     10216   212927922	0.9021	1.0000
 24        96   212932118        77   212932037	0.8021	1.0000
 25        34   212932118        33   212932117	0.9706	1.0000

>>> foo(20)
dimension 93493549->1846655
field	t_size	t_weight	f_size	f_weight	fs_ratio	fw_ratio
  0  23701761   212932118    325019   174771810	0.0137	0.8208
  1     31928   212932118     23089   212873191	0.7232	0.9997
  2     15837   212932118     15346   212927843	0.9690	1.0000
  3      7363   212932118      7052   212930267	0.9578	1.0000
  4     20088   212932118     19047   212925360	0.9482	1.0000
  5         3   212932118         3   212932118	1.0000	1.0000
  6      6772   212932118      6740   212931846	0.9953	1.0000
  7      1355   212932118      1291   212931848	0.9528	1.0000
  8        61   212932118        52   212932071	0.8525	1.0000
  9  14774452   212932118    289382   187686237	0.0196	0.8814
 10    750926   212932118    104102   210934065	0.1386	0.9906
 11    238887   212932118     88436   212191735	0.3702	0.9965
 12        10   212932118        10   212932118	1.0000	1.0000
 13      2209   212932118      2189   212931869	0.9909	1.0000
 14     10223   212932118      8566   212920734	0.8379	0.9999
 15        73   212932118        61   212932063	0.8356	1.0000
 16         4   212932118         4   212932118	1.0000	1.0000
 17       966   212932118       934   212931850	0.9669	1.0000
 18        14   212932118        14   212932118	1.0000	1.0000
 19  27699023   212932118    327099   170338896	0.0118	0.8000
 20   5525455   212932118    216305   202075204	0.0391	0.9490
 21  20377090   212932118    314187   179326633	0.0154	0.8422
 22    317594   212932118     87764   211861608	0.2763	0.9950
 23     11325   212932118      9858   212922497	0.8705	1.0000
 24        96   212932118        72   212931957	0.7500	1.0000
 25        34   212932118        33   212932117	0.9706	1.0000

>>> foo(50)
dimension 93493549->913260
field	t_size	t_weight	f_size	f_weight	fs_ratio	fw_ratio
  0  23701761   212932118    134065   168825931	0.0057	0.7929
  1     31928   212932118     19836   212763344	0.6213	0.9992
  2     15837   212932118     14944   212913847	0.9436	0.9999
  3      7363   212932118      6896   212925118	0.9366	1.0000
  4     20088   212932118     18596   212910235	0.9257	0.9999
  5         3   212932118         3   212932118	1.0000	1.0000
  6      6772   212932118      6705   212930688	0.9901	1.0000
  7      1355   212932118      1279   212931439	0.9439	1.0000
  8        61   212932118        46   212931890	0.7541	1.0000
  9  14774452   212932118    131045   182727002	0.0089	0.8581
 10    750926   212932118     62751   209602933	0.0836	0.9844
 11    238887   212932118     63408   211371196	0.2654	0.9927
 12        10   212932118        10   212932118	1.0000	1.0000
 13      2209   212932118      2151   212930502	0.9737	1.0000
 14     10223   212932118      7795   212894475	0.7625	0.9998
 15        73   212932118        59   212931995	0.8082	1.0000
 16         4   212932118         4   212932118	1.0000	1.0000
 17       966   212932118       924   212931501	0.9565	1.0000
 18        14   212932118        14   212932118	1.0000	1.0000
 19  27699023   212932118    133602   164317875	0.0048	0.7717
 20   5525455   212932118    110519   198729306	0.0200	0.9333
 21  20377090   212932118    133642   173699351	0.0066	0.8157
 22    317594   212932118     55440   210813010	0.1746	0.9900
 23     11325   212932118      9430   212908056	0.8327	0.9999
 24        96   212932118        63   212931656	0.6562	1.0000
 25        34   212932118        33   212932117	0.9706	1.0000

>>> foo(100)
dimension 93493549->555847
field	t_size	t_weight	f_size	f_weight	fs_ratio	fw_ratio
  0  23701761   212932118     68469   164243652	0.0029	0.7713
  1     31928   212932118     17161   212567417	0.5375	0.9983
  2     15837   212932118     14413   212874120	0.9101	0.9997
  3      7363   212932118      6823   212920066	0.9267	0.9999
  4     20088   212932118     18333   212892166	0.9126	0.9998
  5         3   212932118         3   212932118	1.0000	1.0000
  6      6772   212932118      6658   212927106	0.9832	1.0000
  7      1355   212932118      1255   212929646	0.9262	1.0000
  8        61   212932118        42   212931536	0.6885	1.0000
  9  14774452   212932118     71946   178583044	0.0049	0.8387
 10    750926   212932118     41642   208099940	0.0555	0.9773
 11    238887   212932118     47818   210249882	0.2002	0.9874
 12        10   212932118        10   212932118	1.0000	1.0000
 13      2209   212932118      2092   212926080	0.9470	1.0000
 14     10223   212932118      7082   212841890	0.6928	0.9996
 15        73   212932118        59   212931995	0.8082	1.0000
 16         4   212932118         4   212932118	1.0000	1.0000
 17       966   212932118       912   212930708	0.9441	1.0000
 18        14   212932118        14   212932118	1.0000	1.0000
 19  27699023   212932118     67658   159713772	0.0024	0.7501
 20   5525455   212932118     66261   195602770	0.0120	0.9186
 21  20377090   212932118     70298   169270680	0.0034	0.7950
 22    317594   212932118     37799   209554891	0.1190	0.9841
 23     11325   212932118      9004   212876875	0.7951	0.9997
 24        96   212932118        58   212931276	0.6042	1.0000
 25        34   212932118        33   212932117	0.9706	1.0000

>>> foo(200)
dimension 93493549->351288
field	t_size	t_weight	f_size	f_weight	fs_ratio	fw_ratio
  0  23701761   212932118     35311   159629595	0.0015	0.7497
  1     31928   212932118     14292   212154110	0.4476	0.9963
  2     15837   212932118     13637   212758294	0.8611	0.9992
  3      7363   212932118      6752   212909590	0.9170	0.9999
  4     20088   212932118     18145   212863721	0.9033	0.9997
  5         3   212932118         3   212932118	1.0000	1.0000
  6      6772   212932118      6558   212911964	0.9684	0.9999
  7      1355   212932118      1227   212925550	0.9055	1.0000
  8        61   212932118        36   212930583	0.5902	1.0000
  9  14774452   212932118     39583   174061288	0.0027	0.8174
 10    750926   212932118     27038   206035194	0.0360	0.9676
 11    238887   212932118     34878   208400592	0.1460	0.9787
 12        10   212932118        10   212932118	1.0000	1.0000
 13      2209   212932118      1987   212910194	0.8995	0.9999
 14     10223   212932118      6271   212724935	0.6134	0.9990
 15        73   212932118        55   212931427	0.7534	1.0000
 16         4   212932118         4   212932118	1.0000	1.0000
 17       966   212932118       904   212929545	0.9358	1.0000
 18        14   212932118        14   212932118	1.0000	1.0000
 19  27699023   212932118     34551   155106600	0.0012	0.7284
 20   5525455   212932118     39323   191817974	0.0071	0.9008
 21  20377090   212932118     37182   164656914	0.0018	0.7733
 22    317594   212932118     24852   207720567	0.0783	0.9755
 23     11325   212932118      8590   212816144	0.7585	0.9995
 24        96   212932118        52   212930436	0.5417	1.0000
 25        34   212932118        33   212932117	0.9706	1.0000

>>> foo(500)
dimension 93493549->203027
field	t_size	t_weight	f_size	f_weight	fs_ratio	fw_ratio
  0  23701761   212932118     15206   153463376	0.0006	0.7207
  1     31928   212932118     10474   210909940	0.3281	0.9905
  2     15837   212932118     12175   212266669	0.7688	0.9969
  3      7363   212932118      6421   212808444	0.8721	0.9994
  4     20088   212932118     17076   212539368	0.8501	0.9982
  5         3   212932118         3   212932118	1.0000	1.0000
  6      6772   212932118      6306   212824465	0.9312	0.9995
  7      1355   212932118      1167   212906342	0.8613	0.9999
  8        61   212932118        33   212929747	0.5410	1.0000
  9  14774452   212932118     18033   167393661	0.0012	0.7861
 10    750926   212932118     14818   202180552	0.0197	0.9495
 11    238887   212932118     21911   204249785	0.0917	0.9592
 12        10   212932118        10   212932118	1.0000	1.0000
 13      2209   212932118      1751   212829814	0.7927	0.9995
 14     10223   212932118      5058   212330434	0.4948	0.9972
 15        73   212932118        54   212931120	0.7397	1.0000
 16         4   212932118         4   212932118	1.0000	1.0000
 17       966   212932118       877   212921115	0.9079	0.9999
 18        14   212932118        14   212932118	1.0000	1.0000
 19  27699023   212932118     14730   149042719	0.0005	0.7000
 20   5525455   212932118     19243   185548682	0.0035	0.8714
 21  20377090   212932118     16270   158224216	0.0008	0.7431
 22    317594   212932118     13435   204131255	0.0423	0.9587
 23     11325   212932118      7879   212573767	0.6957	0.9983
 24        96   212932118        46   212928589	0.4792	1.0000
 25        34   212932118        33   212932117	0.9706	1.0000

 >>> foo(1000)
dimension 93493549->122678
field	t_size	t_weight	f_size	f_weight	fs_ratio	fw_ratio
  0  23701761   212932118      8062   148461504	0.0003	0.6972
  1     31928   212932118      7946   209106730	0.2489	0.9820
  2     15837   212932118     10626   211137372	0.6710	0.9916
  3      7363   212932118      2252   209156227	0.3059	0.9823
  4     20088   212932118      4534   201564371	0.2257	0.9466
  5         3   212932118         3   212932118	1.0000	1.0000
  6      6772   212932118      5922   212537333	0.8745	0.9981
  7      1355   212932118      1112   212867403	0.8207	0.9997
  8        61   212932118        26   212924886	0.4262	1.0000
  9  14774452   212932118      9829   161646852	0.0007	0.7591
 10    750926   212932118      9041   198114886	0.0120	0.9304
 11    238887   212932118     14696   199147520	0.0615	0.9353
 12        10   212932118         9   212931583	0.9000	1.0000
 13      2209   212932118      1461   212612751	0.6614	0.9985
 14     10223   212932118      4126   211662362	0.4036	0.9940
 15        73   212932118        52   212929704	0.7123	1.0000
 16         4   212932118         4   212932118	1.0000	1.0000
 17       966   212932118       445   212540087	0.4607	0.9982
 18        14   212932118        14   212932118	1.0000	1.0000
 19  27699023   212932118      7771   144170508	0.0003	0.6771
 20   5525455   212932118     10957   179756828	0.0020	0.8442
 21  20377090   212932118      8677   152910154	0.0004	0.7181
 22    317594   212932118      7948   200258847	0.0250	0.9405
 23     11325   212932118      7090   211995924	0.6260	0.9956
 24        96   212932118        42   212925533	0.4375	1.0000
 25        34   212932118        33   212932117	0.9706	1.0000
